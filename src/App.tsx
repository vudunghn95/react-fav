import gsap from "gsap";
import { useEffect, useState } from "react";
import "./App.css";

function App() {
  const [progress, setProgress] = useState(0);

  const handleClick = () => {
    setProgress((prev) => (prev >= 63 ? 63 : prev + 7));
  };

  useEffect(() => {
    gsap.to(".fill-rect", {
      attr: { y: 63 - progress },
      duration: 0.5,
      ease: "power1.out",
    });

    gsap.to(".mouth", {
      duration: 0.2,
      ease: "none",
      attr: {
        d: "M15.52 48C22.5 56.5 35 56 41.48 48",
        // d: "M14 48C22.5 55.5 36 54 43 48",
      },
      yoyo: true,
      repeat: 1,
      onComplete: () => {
        gsap.set("mouth", { attr: { d: "M16 48C22.5 55.5 36 54 41 48" } });
      },
    });

    gsap.to([".eye1", ".eye2"], {
      duration: 0.1, // Blink speed
      ease: "power1.inOut",
      attr: { ry: 0, fillOpacity: progress > 28 ? "1" : "0.2" }, // Close the eyes (by reducing ry)
      yoyo: true, // Reverse the animation automatically (open the eyes)
      repeat: 1, // Blink once
      onComplete: () => {
        // After the blink completes, set ry back to 3 explicitly
        gsap.set([".eye1", ".eye2"], {
          attr: {
            ry: 3,
            fill: progress > 28 ? "#bd081c" : "black",
            fillOpacity: progress > 28 ? "1" : "0.2",
          },
        });
      },
    });

    gsap.to(".cheek", {
      duration: 0.2,
      ease: "none",
      attr: {
        fill: `${progress > 35 ? "#FFC392" : "black"}`,
        "fill-opacity": `${progress > 35 ? "1" : "0.2"}`,
      },
    });

    if (progress === 63) {
      gsap.to([".leaf1", ".leaf2"], {
        rotation: "+=4",
        duration: 0.3, // Duration of each shake
        ease: "none", // No easing for sharp shakes
        repeat: 4, // Repeat the animation infinitely
        yoyo: true, // Make the shake go back and forth
        stagger: 0.1, // Optional stagger between shakes
        onComplete: () => {
          gsap.set([".leaf1", ".leaf2"], { attr: { rotation: 0 } });
        },
      });
      gsap.to([".leaf1", ".leaf2"], {
        duration: 0.5,
        ease: "power1.inOut",
        attr: { fill: "#179967", "fill-opacity": "1" },
      });

      gsap.to([".pedicel"], {
        duration: 0.5,
        ease: "power1.inOut",
        attr: { fill: "#75432E", "fill-opacity": "1" },
      });
    }
  }, [progress]);

  return (
    <div className="orange" onClick={handleClick}>
      <svg
        width="59"
        height="63"
        viewBox="0 0 59 63"
        fill="none"
        xmlns="http://www.w3.org/2000/svg"
      >
        <defs>
          <clipPath id="fillClip">
            <rect x="0" y={63} width="59" height="63" className="fill-rect" />
          </clipPath>
        </defs>

        <path
          d="M58.3059 33.4216C59.4269 48.1879 47.2994 61.1479 31.2185 62.3687C15.1377 63.5894 1.19283 52.6086 0.0718562 37.8423C-1.04912 23.076 11.0782 10.116 27.1592 8.89534C43.2402 7.67469 57.1849 18.6553 58.3059 33.4216Z"
          fill="black"
          fillOpacity={0.2}
        />
        <path
          d="M58.3059 33.4216C59.4269 48.1879 47.2994 61.1479 31.2185 62.3687C15.1377 63.5894 1.19283 52.6086 0.0718562 37.8423C-1.04912 23.076 11.0782 10.116 27.1592 8.89534C43.2402 7.67469 57.1849 18.6553 58.3059 33.4216Z"
          fill="#FD7F20"
          clipPath="url(#fillClip)"
          fillOpacity={1}
        />
        <path
          d="M28.7214 11.1079C28.7214 11.1079 28.7225 10.9307 28.7244 10.6204C28.7249 10.5817 28.7254 10.5408 28.7259 10.4981C28.7274 10.4551 28.7295 10.409 28.7223 10.3736C28.7128 10.298 28.7025 10.2162 28.6915 10.1287C28.6812 10.0443 28.6701 9.95436 28.6584 9.85955C28.6391 9.75724 28.6187 9.64969 28.5975 9.53752C28.5646 9.3168 28.4908 9.07984 28.4303 8.83688C28.4047 8.71546 28.3525 8.59205 28.3109 8.46776C28.2893 8.40605 28.2675 8.34372 28.2454 8.28077C28.2251 8.21806 28.2011 8.1556 28.1723 8.09327C28.1193 7.97011 28.0655 7.84482 28.011 7.71803C27.9573 7.59299 27.8829 7.47183 27.8209 7.34941C27.7889 7.28883 27.7569 7.22799 27.7247 7.16691L27.6132 6.99053C27.5377 6.87412 27.474 6.75457 27.3929 6.6439C27.3122 6.5351 27.2317 6.4263 27.1514 6.31788C27.1146 6.26304 27.0683 6.2137 27.0241 6.16411L26.8937 6.01646C26.8522 5.96749 26.8107 5.91878 26.7696 5.87019C26.7267 5.82334 26.6789 5.78062 26.635 5.73628C26.5449 5.64921 26.4611 5.56152 26.3749 5.48033C26.2837 5.40538 26.1939 5.33168 26.1061 5.25948C26.0621 5.22463 26.0234 5.18603 25.9779 5.15556C25.9328 5.12533 25.8881 5.09535 25.8441 5.06587C25.7567 5.00741 25.6796 4.94508 25.6032 4.88762C25.5191 4.83915 25.4408 4.79118 25.3718 4.73934C25.2328 4.63554 25.1008 4.5536 24.9872 4.47728C24.9315 4.43768 24.8828 4.39621 24.8365 4.35948C24.786 4.32925 24.7427 4.29753 24.7032 4.26905C24.6232 4.21371 24.5662 4.16062 24.5269 4.12415C24.4888 4.08555 24.4685 4.06506 24.4685 4.06506L23.9198 3.51082C23.119 2.70176 23.1256 1.39679 23.9347 0.595966C24.6647 -0.126534 25.7985 -0.191239 26.6015 0.397103C26.6015 0.397103 26.6436 0.427957 26.7225 0.485667C26.8022 0.541628 26.9193 0.623696 27.0682 0.728124C27.1424 0.780338 27.2241 0.838797 27.3147 0.89938C27.4004 0.966709 27.4931 1.03966 27.5922 1.11748C27.6906 1.19592 27.7954 1.27949 27.9058 1.36756C28.0171 1.45462 28.1228 1.55792 28.239 1.6601C28.3543 1.76341 28.4744 1.87096 28.5987 1.98225C28.7147 2.10167 28.8344 2.22509 28.9576 2.352C29.0197 2.41545 29.0826 2.47979 29.1464 2.54487C29.2098 2.61032 29.2651 2.68314 29.326 2.7536C29.4449 2.897 29.5663 3.04339 29.6897 3.19229C29.8049 3.34693 29.9156 3.50895 30.0304 3.67196C30.0866 3.75403 30.1463 3.83522 30.2002 3.92016C30.2515 4.0066 30.3029 4.09354 30.3546 4.18086C30.406 4.26867 30.4576 4.35673 30.5093 4.44505C30.561 4.53361 30.6141 4.62205 30.6568 4.71536C30.7467 4.90086 30.8369 5.08698 30.9271 5.27322C31.0152 5.46084 31.0833 5.65646 31.1608 5.84845C31.1984 5.94501 31.236 6.04132 31.2735 6.13738C31.3049 6.23568 31.3361 6.33361 31.3672 6.43117C31.4263 6.62754 31.4957 6.82053 31.5424 7.01702C31.5879 7.2145 31.6328 7.40962 31.677 7.60161C31.7008 7.69754 31.7174 7.7941 31.7307 7.89066C31.7451 7.98709 31.7593 8.08253 31.7734 8.17696C31.799 8.36646 31.8337 8.5512 31.8409 8.73483C31.8647 9.10095 31.8957 9.44871 31.8842 9.77448C31.8822 9.93737 31.8803 10.0936 31.8786 10.2422C31.866 10.4048 31.849 10.5641 31.8334 10.7116C31.816 10.86 31.7998 10.9989 31.7846 11.1273C31.7808 11.1568 31.7763 11.1967 31.7728 11.2159C31.7692 11.2373 31.7657 11.2585 31.7623 11.2791C31.7554 11.3203 31.7489 11.3595 31.7427 11.3967C31.6931 11.6948 31.6647 11.865 31.6647 11.865C31.5303 12.6732 30.7661 13.2193 29.958 13.0849C29.2288 12.9636 28.7129 12.3295 28.7179 11.6131L28.7214 11.1079Z"
          fill="black"
          fillOpacity="0.2"
          className="pedicel"
        />
        <path
          d="M29.3121 12.7313C29.3121 12.7313 29.3412 12.7035 29.3974 12.6494C29.4531 12.5978 29.5363 12.5186 29.6416 12.4286C29.6944 12.3828 29.7535 12.3316 29.8185 12.2753C29.8824 12.2232 29.9523 12.1663 30.0277 12.1049C30.0648 12.0738 30.106 12.0432 30.1436 12.0084C30.1748 11.9733 30.2071 11.937 30.2403 11.8994C30.305 11.8253 30.3705 11.7462 30.4354 11.6626C30.5009 11.5752 30.5628 11.5004 30.6244 11.4148C30.6394 11.3939 30.6546 11.3726 30.67 11.3511C30.6881 11.3285 30.7065 11.3057 30.7251 11.2826C30.7616 11.2361 30.7989 11.1886 30.837 11.1403C30.9111 11.0486 30.9847 10.9552 31.0572 10.86C31.0926 10.8141 31.1284 10.7675 31.165 10.7201C31.2013 10.6702 31.2381 10.6195 31.2756 10.5679C31.4236 10.364 31.5571 10.1736 31.7025 9.95911C31.8354 9.76112 31.9751 9.55301 32.1209 9.33579C32.3941 8.9282 32.6875 8.50262 33.0008 8.11813C33.0822 8.01221 33.1664 7.91977 33.2495 7.82421C33.3289 7.72878 33.423 7.63334 33.5135 7.53866C33.5593 7.49219 33.6035 7.44135 33.6502 7.39838C33.6977 7.35379 33.7454 7.30894 33.7933 7.26385C33.8431 7.21751 33.892 7.16867 33.9424 7.12407C33.9931 7.08135 34.0442 7.03838 34.0953 6.99529C34.1477 6.95082 34.2004 6.9061 34.2533 6.86125C34.3086 6.81928 34.3643 6.77719 34.4202 6.73497C34.5316 6.65015 34.6408 6.56696 34.7657 6.48676C34.8873 6.40669 35.007 6.32013 35.1327 6.24793C35.2612 6.16786 35.395 6.09229 35.5289 6.01959C35.6607 5.94776 35.8028 5.87681 35.9471 5.80524C36.0929 5.73641 36.234 5.67183 36.3879 5.607C36.5412 5.54092 36.6987 5.48421 36.8542 5.42225L37.0932 5.32894C37.1749 5.29871 37.2581 5.27236 37.3405 5.24387C37.5061 5.18891 37.6682 5.13033 37.8434 5.07624C38.0174 5.0259 38.1912 4.97569 38.3647 4.9256C38.542 4.87251 38.7279 4.83541 38.9082 4.78994L39.1807 4.72498L39.4649 4.67077C39.6558 4.63705 39.8377 4.59395 40.033 4.56972C40.2288 4.54261 40.4234 4.51575 40.617 4.48902C40.8165 4.47054 41.0148 4.4523 41.2117 4.43406C41.4122 4.41782 41.6069 4.41108 41.8109 4.40271C42.013 4.39234 42.2174 4.39696 42.417 4.39696C42.5169 4.39771 42.6154 4.39709 42.7189 4.40108C42.8215 4.40683 42.9235 4.41245 43.0251 4.4182C43.2287 4.43006 43.423 4.43931 43.6272 4.46479C43.831 4.48915 44.0294 4.50776 44.2272 4.54136C44.617 4.59595 45.0197 4.68676 45.3882 4.77458C45.5778 4.82616 45.7662 4.8795 45.9473 4.93509C46.1307 4.99592 46.3037 5.04963 46.4794 5.11546C46.6532 5.18616 46.8232 5.25537 46.9894 5.32307C47.1546 5.39789 47.3103 5.46622 47.4672 5.54667C47.623 5.62911 47.7722 5.71043 47.9148 5.78987C48.0585 5.87594 48.1926 5.95188 48.3258 6.04095C48.4579 6.13176 48.5833 6.21957 48.7024 6.30564C48.8213 6.39558 48.9337 6.48139 49.0398 6.56608C49.146 6.65552 49.247 6.74583 49.3408 6.83352C49.4329 6.92434 49.5207 7.01103 49.6039 7.09322C49.6853 7.17704 49.7614 7.24974 49.8307 7.33018C49.9002 7.41025 49.9639 7.49069 50.0221 7.56264C50.139 7.70405 50.2319 7.8417 50.3063 7.94663C50.4538 8.16248 50.5236 8.29151 50.5236 8.29151L50.5551 8.34985C50.7341 8.68062 50.6459 9.08434 50.365 9.3138C50.365 9.3138 50.2685 9.39262 50.1003 9.52079C49.9315 9.65269 49.6958 9.81746 49.4156 10.0423C49.3472 10.0969 49.275 10.1545 49.1993 10.2149C49.125 10.274 49.0494 10.3261 48.9709 10.3909C48.8939 10.4563 48.8136 10.5242 48.7304 10.5948C48.6505 10.6602 48.5677 10.7282 48.4823 10.7983C48.3991 10.8616 48.3118 10.9428 48.2256 11.017C48.1405 11.0892 48.0531 11.1635 47.9633 11.2398C47.8758 11.3088 47.7844 11.3936 47.6941 11.4738C47.6048 11.5506 47.5135 11.6292 47.4201 11.7095C47.3283 11.7855 47.2325 11.8729 47.1386 11.9557C47.0449 12.0355 46.9496 12.117 46.8525 12.1997C46.7549 12.2866 46.6557 12.3679 46.5571 12.4534C46.4578 12.5363 46.357 12.6205 46.2548 12.7058C46.1529 12.7955 46.0478 12.8748 45.9439 12.9592C45.8402 13.0448 45.7298 13.1334 45.6215 13.2171C45.5674 13.2596 45.513 13.3024 45.4583 13.3454C45.4024 13.3874 45.3462 13.4296 45.2899 13.472C45.176 13.5579 45.063 13.6481 44.9464 13.7276C44.4773 14.0746 43.9818 14.4029 43.4375 14.7318L43.2357 14.8543L43.0252 14.9739C42.8835 15.0525 42.745 15.1373 42.6 15.211C42.4525 15.2885 42.3047 15.3662 42.1568 15.4441C42.0098 15.5186 41.8529 15.5916 41.6987 15.6668C41.0819 15.9562 40.425 16.2439 39.7256 16.4619C39.0341 16.6849 38.2846 16.8581 37.5301 16.965C36.771 17.0722 35.9821 17.1068 35.2156 17.0648C34.4364 17.0147 33.6889 16.8964 32.9866 16.6853C32.643 16.591 32.3069 16.4621 31.9972 16.3277C31.8433 16.2647 31.6953 16.1937 31.5495 16.1157C31.405 16.0425 31.2675 15.9603 31.1368 15.8856C30.6079 15.5697 30.2065 15.222 29.8522 14.8884C29.7685 14.8045 29.6924 14.7252 29.6232 14.6509C29.5888 14.6131 29.5554 14.5789 29.5247 14.5417C29.4987 14.5042 29.4785 14.4674 29.4562 14.4323C29.4131 14.3618 29.3733 14.2966 29.3368 14.2369C29.3011 14.1739 29.2686 14.1169 29.2395 14.0656C29.1809 13.9651 29.1383 13.8785 29.1092 13.8218C29.0801 13.765 29.0651 13.7357 29.0651 13.7357C28.905 13.423 28.9771 13.0523 29.218 12.8207L29.3121 12.7313Z"
          fill="black"
          fillOpacity="0.2"
          className="leaf2"
        />
        <path
          d="M18.5089 5.09458C18.5089 5.09458 18.5276 5.09159 18.5638 5.08584C18.5999 5.08009 18.6543 5.0706 18.7209 5.06361C18.7886 5.05336 18.8721 5.04937 18.963 5.03725C19.0527 5.01714 19.1451 5.00202 19.2468 4.97779C19.3422 4.95356 19.4672 4.94007 19.5878 4.91558C19.7075 4.8971 19.8368 4.87698 19.975 4.85562C20.2446 4.81715 20.5433 4.78118 20.8559 4.76119C21.1743 4.73996 21.506 4.73458 21.859 4.75282C22.2079 4.77106 22.578 4.8144 22.9526 4.8881C23.332 4.96005 23.7161 5.06685 24.1068 5.20713C24.4975 5.34728 24.887 5.52491 25.2771 5.73139C25.6651 5.93563 26.0522 6.17271 26.4208 6.44065C26.7911 6.70459 27.1467 7.00613 27.471 7.32816C27.7963 7.65706 28.0924 8.00032 28.3449 8.36919C28.5986 8.72919 28.8058 9.11417 28.9642 9.48017C29.0421 9.66629 29.1061 9.85291 29.1624 10.0253C29.1862 10.116 29.2091 10.2043 29.2316 10.2902C29.2497 10.3765 29.2672 10.4604 29.2842 10.5416C29.2986 10.624 29.3102 10.7051 29.321 10.7818C29.3281 10.8597 29.3351 10.9348 29.3417 11.0069C29.3563 11.1475 29.3499 11.2874 29.3464 11.4068C29.3437 11.644 29.3015 11.8397 29.2754 11.9667C29.246 12.0955 29.2246 12.1629 29.2246 12.1629C29.1593 12.369 28.9393 12.4832 28.7331 12.4179C28.7302 12.417 28.7274 12.416 28.7244 12.415L28.6941 12.4045C28.6941 12.4045 28.6309 12.3825 28.5125 12.3413C28.3978 12.301 28.2446 12.2405 28.0495 12.18C28.0021 12.1652 27.9524 12.1496 27.9001 12.1332C27.8496 12.1168 27.8006 12.0986 27.743 12.0839C27.688 12.0691 27.6306 12.0538 27.5712 12.0378C27.5146 12.021 27.4591 12.0033 27.3994 11.9874C27.3384 11.9733 27.2755 11.9587 27.2107 11.9436C27.15 11.9283 27.0875 11.9127 27.0234 11.8966C26.8973 11.8683 26.7647 11.8384 26.6263 11.8072C26.3637 11.7501 26.0792 11.6883 25.7783 11.6228C25.4894 11.5555 25.1789 11.4855 24.8695 11.4002C24.5521 11.3185 24.2336 11.2203 23.9016 11.1089C23.5691 11 23.2343 10.8718 22.8913 10.7301C22.5523 10.5867 22.2043 10.4321 21.8679 10.2483C21.5311 10.0653 21.1965 9.86028 20.8812 9.62857C20.5615 9.39785 20.26 9.14753 19.9772 8.87609C19.697 8.60803 19.4365 8.31723 19.2118 8.02618C18.9844 7.73026 18.7917 7.43346 18.6369 7.14441C18.5605 6.99689 18.4947 6.86036 18.4346 6.72545C18.4075 6.6565 18.3815 6.59042 18.3567 6.52722C18.3338 6.46526 18.3087 6.4058 18.2871 6.33972C18.245 6.21256 18.209 6.10538 18.187 6.0052C18.1687 5.90989 18.1629 5.83032 18.1563 5.76125C18.1491 5.69479 18.1471 5.63958 18.1449 5.60311C18.1429 5.56663 18.1419 5.54777 18.1419 5.54777C18.1303 5.32393 18.2925 5.12993 18.5089 5.09458Z"
          fill="black"
          fillOpacity="0.2"
          className="leaf1"
        />
        <path
          d="M9.53232 32.2126C9.08975 32.2126 8.63994 32.13 8.20387 31.9556C6.36764 31.2214 5.47426 29.1375 6.20863 27.3014C7.55932 23.9236 10.0681 20.9681 13.2726 18.9794C14.9529 17.9367 17.1604 18.4536 18.2032 20.1338C19.246 21.8142 18.7291 24.0216 17.0487 25.0644C15.1337 26.2528 13.6453 27.9916 12.8581 29.9604C12.2983 31.3604 10.9535 32.2126 9.53232 32.2126Z"
          className="cheek"
        />
        <ellipse
          cx="40.5"
          cy="31"
          rx="2.5"
          ry="3"
          className="eye1"
          fillOpacity={progress > 28 ? "1" : "0.2"}
        />
        <ellipse
          cx="18.5"
          cy="31"
          rx="2.5"
          ry="3"
          className="eye2"
          fillOpacity={progress > 28 ? "1" : "0.2"}
        />
        <path
          d="M16 48C22.5 55.5 36 54 41 48"
          stroke={progress > 14 ? "#bd081c" : "black"}
          strokeOpacity={progress > 14 ? 1 : 0.2}
          className="mouth"
        />
      </svg>
    </div>
  );
}

export default App;
